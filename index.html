<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SESA - SMAN Kalisat</title>
    
    <!-- Font dan Library -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-container">
        <div class="login-background"></div>
        <div class="login-card fade-in">
            <div class="login-logo">
                <div class="logo-circle">S</div>
                <h1 class="text-2xl font-bold text-gray-800">SESA</h1>
                <p class="text-gray-600 mt-1 text-sm">Sistem Edukasi Siswa Aktif</p>
                <p class="text-xs text-gray-500 mt-1">SMAN Kalisat</p>
            </div>
            
            <form id="login-form">
                <div class="form-group">
                    <label class="form-label">NOMOR INDUK SISWA</label>
                    <input type="text" id="nis-input" class="form-input" placeholder="Masukkan NIS Anda" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">KATA SANDI</label>
                    <input type="password" id="password-input" class="form-input" placeholder="Masukkan kata sandi" required>
                </div>
                
                <button type="submit" class="login-btn">
                    <span>‚Üí</span>
                    <span class="ml-2">Masuk ke SESA</span>
                </button>
            </form>
            
            <div class="demo-info">
                <strong class="block mb-2">Akses Demo:</strong>
                <div class="flex justify-between">
                    <span>NIS: <code class="bg-indigo-100 px-2 py-1 rounded text-xs">2024001</code></span>
                    <span>Password: <code class="bg-indigo-100 px-2 py-1 rounded text-xs">siswa123</code></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App (Hidden until login) -->
    <div id="main-app" class="hidden">
        <!-- Loading Screen -->
        <div id="loading" class="fixed inset-0 bg-white flex items-center justify-center z-50">
            <div class="text-center">
                <div class="loading-spinner mx-auto mb-4"></div>
                <p class="text-gray-600">Memuat SESA...</p>
            </div>
        </div>

        <!-- Mobile Overlay -->
        <div id="mobile-overlay" class="mobile-overlay"></div>

        <div class="flex h-screen">
            <!-- Sidebar -->
            <div id="sidebar" class="sidebar">
                <!-- Sidebar content remains the same as your original -->
                <div class="p-6 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 gradient-primary rounded-lg flex items-center justify-center text-white font-bold">
                                S
                            </div>
                            <div>
                                <h1 class="text-xl font-bold text-gray-800">SESA</h1>
                                <p class="text-xs text-gray-500">SMAN Kalisat</p>
                            </div>
                        </div>
                        <button id="sidebar-toggle" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-bars"></i>
                        </button>
                    </div>
                </div>
                
                <div class="flex-1 p-4 custom-scrollbar overflow-y-auto">
                    <nav class="space-y-2">
                        <button onclick="navigateTo('dashboard')" class="nav-btn w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-all duration-300 hover:bg-indigo-50 text-gray-700" data-page="dashboard">
                            <i class="fas fa-chart-pie w-5 text-center"></i>
                            <span class="font-medium">Dashboard</span>
                        </button>
                        <button onclick="navigateTo('schedule')" class="nav-btn w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-all duration-300 hover:bg-indigo-50 text-gray-700" data-page="schedule">
                            <i class="fas fa-calendar-alt w-5 text-center"></i>
                            <span class="font-medium">Jadwal</span>
                        </button>
                        <button onclick="navigateTo('tasks')" class="nav-btn w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-all duration-300 hover:bg-indigo-50 text-gray-700" data-page="tasks">
                            <i class="fas fa-tasks w-5 text-center"></i>
                            <span class="font-medium">Tugas</span>
                        </button>
                        <button onclick="navigateTo('subjects')" class="nav-btn w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-all duration-300 hover:bg-indigo-50 text-gray-700" data-page="subjects">
                            <i class="fas fa-book w-5 text-center"></i>
                            <span class="font-medium">Mata Pelajaran</span>
                        </button>
                        <button onclick="navigateTo('ebooks')" class="nav-btn w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-all duration-300 hover:bg-indigo-50 text-gray-700" data-page="ebooks">
                            <i class="fas fa-file-alt w-5 text-center"></i>
                            <span class="font-medium">E-Book</span>
                        </button>
                    </nav>
                    
                    <div class="mt-8 pt-4 border-t border-gray-200">
                        <button onclick="showSettings()" class="w-full flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-indigo-50 transition-all text-gray-700">
                            <i class="fas fa-cog w-5 text-center"></i>
                            <span>Pengaturan</span>
                        </button>
                        <button onclick="confirmLogout()" class="w-full flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-red-50 transition-all text-red-600 mt-2">
                            <i class="fas fa-sign-out-alt w-5 text-center"></i>
                            <span>Keluar</span>
                        </button>
                    </div>
                </div>
                
                <div class="p-4 border-t border-gray-200">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-800" id="sidebar-user-name">Siswa SMAN Kalisat</p>
                            <p class="text-xs text-gray-500" id="sidebar-user-class">Kelas XI IPA 1</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content Area -->
            <div class="main-content-area">
                <!-- Header -->
                <header class="bg-white shadow-sm z-30">
                    <div class="flex items-center justify-between p-4">
                        <div class="flex items-center space-x-4">
                            <button id="mobile-menu-toggle" class="md:hidden text-gray-600">
                                <i class="fas fa-bars text-xl"></i>
                            </button>
                            <div class="relative">
                                <input type="text" id="search-input" placeholder="Cari tugas, jadwal..." class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent w-64">
                                <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                            </div>
                        </div>
                        
                        <div class="flex items-center space-x-4">
                            <div class="user-menu">
                                <button id="user-menu-button" class="flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 transition-all">
                                    <div class="w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600">
                                        <i class="fas fa-user"></i>
                                    </div>
                                    <span class="text-sm font-medium text-gray-700 hidden md:block" id="header-user-name">Siswa</span>
                                    <i class="fas fa-chevron-down text-gray-400 text-xs"></i>
                                </button>
                                <div id="user-dropdown" class="user-dropdown">
                                    <div class="user-dropdown-item" onclick="showSettings()">
                                        <i class="fas fa-cog mr-2 text-gray-500"></i>
                                        <span>Pengaturan</span>
                                    </div>
                                    <div class="user-dropdown-item" onclick="confirmLogout()">
                                        <i class="fas fa-sign-out-alt mr-2 text-gray-500"></i>
                                        <span>Keluar</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </header>

                <!-- Content Area -->
                <div class="content-wrapper custom-scrollbar">
                    <div id="main-content" class="max-w-7xl mx-auto"></div>
                </div>
            </div>
        </div>

        <!-- Floating Action Button -->
        <div class="fab" onclick="toggleFabMenu()">
            <i class="fas fa-plus"></i>
        </div>
        
        <div id="fab-menu" class="fab-menu">
            <div class="fab-item" onclick="showAddTask()" title="Tambah Tugas">
                <i class="fas fa-tasks"></i>
            </div>
            <div class="fab-item" onclick="showAddSchedule()" title="Tambah Jadwal">
                <i class="fas fa-calendar-plus"></i>
            </div>
            <div class="fab-item" onclick="navigateTo('ebooks')" title="Buka E-Book">
                <i class="fas fa-book-open"></i>
            </div>
        </div>

        <!-- Modals -->
        <div id="modal-add-task" class="modal-overlay">
            <div class="modal-content">
                <h3 class="text-xl font-bold mb-4 text-gray-800">‚ûï Tambah Tugas Baru</h3>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700">Nama Tugas</label>
                        <input id="new-task-name" type="text" placeholder="Contoh: Tugas Matematika Bab 5" class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700">Mata Pelajaran</label>
                        <select id="new-task-subject" class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="">Pilih Mata Pelajaran</option>
                            <option value="Matematika">Matematika</option>
                            <option value="Bahasa Indonesia">Bahasa Indonesia</option>
                            <option value="Fisika">Fisika</option>
                            <option value="Kimia">Kimia</option>
                            <option value="Biologi">Biologi</option>
                            <option value="Bahasa Inggris">Bahasa Inggris</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700">Deadline</label>
                        <input id="new-task-deadline" type="date" class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div class="flex space-x-3 pt-4">
                        <button onclick="closeAddTask()" class="flex-1 px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-100 transition-all font-medium">Batal</button>
                        <button onclick="saveNewTask()" class="flex-1 bg-indigo-600 text-white px-4 py-3 rounded-lg hover:bg-indigo-700 transition-all font-medium shadow-lg">Simpan</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="modal-settings" class="modal-overlay">
            <div class="modal-content">
                <h3 class="text-xl font-bold mb-6 text-gray-800">‚öôÔ∏è Pengaturan Profil</h3>
                
                <div class="space-y-6">
                    <div class="flex flex-col items-center mb-6">
                        <div class="relative">
                            <div class="w-32 h-32 gradient-primary rounded-full flex items-center justify-center overflow-hidden shadow-lg">
                                <img id="profile-photo-display" src="" alt="Profile" class="w-full h-full object-cover hidden">
                                <span id="profile-photo-placeholder" class="text-6xl text-white">üë§</span>
                            </div>
                            <label class="absolute bottom-0 right-0 bg-indigo-600 text-white p-3 rounded-full cursor-pointer hover:bg-indigo-700 transition-all shadow-lg">
                                <span class="text-xl">üì∑</span>
                                <input id="profile-photo-input" type="file" accept="image/*" class="hidden" onchange="handlePhotoUpload(event)">
                            </label>
                        </div>
                        <p class="text-sm text-gray-600 mt-3">Klik ikon kamera untuk mengubah foto</p>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700">Nama Lengkap</label>
                        <input id="profile-name" type="text" class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>

                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700">NIS</label>
                        <input id="profile-nis" type="text" class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" readonly>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700">Kelas</label>
                        <input id="profile-class" type="text" class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>

                    <div>
                        <label class="block text-sm font-semibold mb-2 text-gray-700">Email</label>
                        <input id="profile-email" type="email" class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>

                    <div class="flex space-x-3 pt-4">
                        <button onclick="closeSettings()" class="flex-1 px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-100 transition-all font-medium">Batal</button>
                        <button onclick="saveSettings()" class="flex-1 bg-indigo-600 text-white px-4 py-3 rounded-lg hover:bg-indigo-700 transition-all font-medium shadow-lg">Simpan Perubahan</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="js/firebase-config.js"></script>
    <script src="js/utils/constants.js"></script>
    <script src="js/utils/helpers.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/modules/timer.js"></script>
    <script src="js/modules/dashboard.js"></script>
    <script src="js/modules/tasks.js"></script>
    <script src="js/modules/schedule.js"></script>
    <script src="js/modules/subjects.js"></script>
    <script src="js/modules/ebooks.js"></script>
    <script src="js/navigation.js"></script>
    <script src="js/app.js"></script>
</body>
</html>